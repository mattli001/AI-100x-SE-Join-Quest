Feature: 中國象棋（象棋）規則

  身為玩家
  我想遵守標準中國象棋規則
  以便我能正確地進行遊戲

  我們使用 (row, col) 表示 9×10 棋盤上的座標.
  第 1 列為紅方底線；第 10 列為黑方頂線.
  第 1 行從紅方視角為最左邊的一行.

  每個情境僅擺放與該測試相關的最少棋子.

#################################################################
# 1) GENERAL (將/帥)
#################################################################

@General
Scenario: 紅將在九宮內移動（合法）
  Given 棋盤為空，僅有一枚紅將於 (1, 5)
  When 紅方將從 (1, 5) 移動至 (1, 4)
  Then 此步合法

@General
Scenario: 紅將離開九宮（不合法）
  Given 棋盤為空，僅有一枚紅將於 (1, 6)
  When 紅方將從 (1, 6) 移動至 (1, 7)
  Then 此步不合法

@General
Scenario: 兩將同列相對（不合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅將 | (2, 4) |
    | 黑將 | (8, 5) |
  When 紅方將從 (2, 4) 移動至 (2, 5)
  Then 此步不合法

#################################################################
# 2) GUARD (士/仕)
#################################################################

@Guard
Scenario: 紅士在九宮內斜向移動（合法）
  Given 棋盤為空，僅有一枚紅士於 (1, 4)
  When 紅方士從 (1, 4) 移動至 (2, 5)
  Then 此步合法

@Guard
Scenario: 紅士直線移動（不合法）
  Given 棋盤為空，僅有一枚紅士於 (2, 5)
  When 紅方士從 (2, 5) 移動至 (2, 6)
  Then 此步不合法

#################################################################
# 3) ROOK (車)
#################################################################

@Rook
Scenario: 紅車沿空橫線行走（合法）
  Given 棋盤為空，僅有一枚紅車於 (4, 1)
  When 紅方車從 (4, 1) 移動至 (4, 9)
  Then 此步合法

@Rook
Scenario: 紅車嘗試跳過棋子（不合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅車 | (4, 1) |
    | 黑卒 | (4, 5) |
  When 紅方車從 (4, 1) 移動至 (4, 9)
  Then 此步不合法

#################################################################
# 4) HORSE (馬/傌)
#################################################################

@Horse
Scenario: 紅馬走「日」字且無阻擋（合法）
  Given 棋盤為空，僅有一枚紅馬於 (3, 3)
  When 紅方馬從 (3, 3) 移動至 (5, 4)
  Then 此步合法

@Horse
Scenario: 紅馬被臨位棋子阻擋（不合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅馬 | (3, 3) |
    | 黑車 | (4, 3) | # 臨位阻馬腿
  When 紅方馬從 (3, 3) 移動至 (5, 4)
  Then 此步不合法

#################################################################
# 5) CANNON (炮)
#################################################################

@Cannon
Scenario: 紅炮如車般行走且路徑無阻（合法）
  Given 棋盤為空，僅有一枚紅炮於 (6, 2)
  When 紅方炮從 (6, 2) 移動至 (6, 8)
  Then 此步合法

@Cannon
Scenario: 紅炮隔一子吃子（合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅炮 | (6, 2) |
    | 黑卒 | (6, 5) | # 炮架
    | 黑士 | (6, 8) | # 目標
  When 紅方炮從 (6, 2) 移動至 (6, 8)
  Then 此步合法

@Cannon
Scenario: 紅炮無隔子嘗試吃子（不合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅炮 | (6, 2) |
    | 黑士 | (6, 8) |
  When 紅方炮從 (6, 2) 移動至 (6, 8)
  Then 此步不合法

@Cannon
Scenario: 紅炮隔多子嘗試吃子（不合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅炮 | (6, 2) |
    | 紅兵 | (6, 4) |
    | 黑卒 | (6, 5) |
    | 黑士 | (6, 8) |
  When 紅方炮從 (6, 2) 移動至 (6, 8)
  Then 此步不合法

#################################################################
# 6) ELEPHANT (相/象)
#################################################################

@Elephant
Scenario: 紅相兩格斜走且象眼無阻（合法）
  Given 棋盤為空，僅有一枚紅相於 (3, 3)
  When 紅方相從 (3, 3) 移動至 (5, 5)
  Then 此步合法

@Elephant
Scenario: 紅相嘗試過河（不合法）
  Given 棋盤為空，僅有一枚紅相於 (5, 3)
  When 紅方相從 (5, 3) 移動至 (7, 5)
  Then 此步不合法

@Elephant
Scenario: 紅相象眼被阻（不合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅相 | (3, 3) |
    | 黑車 | (4, 4) | # 象眼
  When 紅方相從 (3, 3) 移動至 (5, 5)
  Then 此步不合法

#################################################################
# 7) SOLDIER / PAWN (兵/卒)
#################################################################

@Soldier
Scenario: 紅兵過河前向前移動（合法）
  Given 棋盤為空，僅有一枚紅兵於 (3, 5)
  When 紅方兵從 (3, 5) 移動至 (4, 5)
  Then 此步合法

@Soldier
Scenario: 紅兵過河前嘗試橫走（不合法）
  Given 棋盤為空，僅有一枚紅兵於 (3, 5)
  When 紅方兵從 (3, 5) 移動至 (3, 4)
  Then 此步不合法

@Soldier
Scenario: 紅兵過河後橫走（合法）
  Given 棋盤為空，僅有一枚紅兵於 (6, 5)
  When 紅方兵從 (6, 5) 移動至 (6, 4)
  Then 此步合法

@Soldier
Scenario: 紅兵過河後嘗試後退（不合法）
  Given 棋盤為空，僅有一枚紅兵於 (6, 5)
  When 紅方兵從 (6, 5) 移動至 (5, 5)
  Then 此步不合法

#################################################################
# 8) WINNING AND LOSING (輸贏)
#################################################################

@Winning
Scenario: 紅方吃掉對方將軍並立即獲勝（合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅車 | (5, 5) |
    | 黑將 | (5, 8) |
  When 紅方車從 (5, 5) 移動至 (5, 8)
  Then 紅方立即獲勝

@Winning
Scenario: 紅方吃掉非將軍棋子，遊戲繼續（合法）
  Given 棋盤包含：
    | 棋子 | 座標 |
    | 紅車 | (5, 5) |
    | 黑炮 | (5, 8) |
  When 紅方車從 (5, 5) 移動至 (5, 8)
  Then 僅此吃子並不結束遊戲
